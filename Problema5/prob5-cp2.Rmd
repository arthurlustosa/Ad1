---
title: "prob5-cp2"
output: html_document
---

```{r setup, include=FALSE}
library(dplyr)
require(GGally)
library(ggplot2)
theme_set(theme_bw())
library(broom)


dados <- read.csv("dados/speed-dating.csv")
```

O clima de amor está no ar. Os dados utlizados nessa análise são referentes a várias rodadas de encontros relâmpagos (Speed Dating) entre 310 jovens americanos. A princípio os dados foram reduzidos, retiradas algumas colunas, para agilizar o processamento, os dados foram coletados por professores da Columbiam Business School. 
Como a coleta dos dados ocorreu? Os participantes dos encontros preencheram fichas referentes a cada um dos encontros que participou durante a noite, cada encontro durava em torno de 4 minutos. Cada linha da tabela representa um encontro.
Vamos iniciar nossa análise dando uma olhada nos dados. 
```{r}
# a correlação dos interesses (int_corr) de p1 e p2 influencia a probabilidade (prob) deles terem um novo encontro?
# quais variaveis mais influenciam na probabilidade de p1 achar que p2 toparia outro encontro?



summary(dados)

ggplot(dados[1:10,], aes(x = int_corr, y = prob)) + 
  geom_point(alpha = 0.4)

ggplot(dados, aes(x = age, y = attr)) + 
  geom_hex()


```

```{r}
mod <- lm(attr ~ ., data = dados)
# R básico:
summary(mod)
confint(mod)

# broom: 
tidy(mod, conf.int = TRUE)
#glance(mod)

ggplot(dados, aes(x = age, y = attr)) + 
  geom_point(alpha = 0.4) + 
  geom_line(aes(y = predict(mod, dados)), colour = "red")

ggplot(mod, aes(hs_grad, .resid)) + 
  geom_point(alpha = .4) + 
  geom_hline(yintercept = 0, colour = "blue")

```


